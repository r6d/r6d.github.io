digraph {
    rankdir=LR;

    // Point d'échange
    ex_l_dns            [label="Log DNS"];
    ex_l_mail           [label="Log Mail"];
    ex_l_www            [label="Log WWW"];
    ex_l_ssh            [label="Log SSH"];
    ex_l_syslog         [label="Log syslog"];
    ex_l_postgresql     [label="Log PostgreSQL"];
    ex_l_twitter        [label="Log Twitter"];
    ex_l_jira           [label="Log JIRA"];
    ex_l_github         [label="Log Github"];

    // Files d'attente

    // Consommateur
    c_logstash          [label="Logstash"];

    subgraph cluster_0 {
        style=filled;
        color=lightgrey;
        label="broker AMQP";

        {ex_l_dns}      ->  {q_dns_ttl;}    [label="#"];
        {ex_l_github}   ->  {q_github_ttl;} [label="#"];
        {ex_l_jira}     ->  {q_jira_ttl;}   [label="#"];
        {ex_l_mail}     ->  {q_mail_ttl;}   [label="#"];
        {ex_l_postgresql}-> {q_postgresql_ttl;}[label="#"];
        {ex_l_ssh}      ->  {q_ssh_ttl;}    [label="#"];
        {ex_l_syslog}   ->  {q_syslog_ttl;} [label="#"];
        {ex_l_twitter}  ->  {q_twitter_ttl;}[label="#"];
        {ex_l_www}      ->  {q_www_ttl;}    [label="#"];
    }

    subgraph cluster_1 {
        style=filled;
        color=lightgrey;
        label="Serveur X";

        xray_bind       -> ex_l_dns;
        xray_postfix    -> ex_l_mail;
        xray_postgresql -> ex_l_postgresql;
    }
    subgraph cluster_2 {
        style=filled;
        color=lightgrey;
        label="Serveur V";

        voyage_apache   -> ex_l_www;
        voyage_bind     -> ex_l_dns;
        voyage_openssh  -> ex_l_ssh;
        voyage_postfix  -> ex_l_mail;
        voyage_twitter  -> ex_l_twitter;
    }
    subgraph cluster_3 {
        style=filled;
        color=lightgrey;
        label="Serveur D";

        db_nginx        -> ex_l_www;
        db_openssh      -> ex_l_ssh;
    }
    subgraph cluster_4 {
        label="Todo";
        
        todo -> ex_l_jira   [color="red"];
        todo -> ex_l_github [color="red"];
        todo -> ex_l_syslog [color="red"];
    }
    // Liens entrées

    // Liens sorties
    {q_dns_ttl;q_mail_ttl;q_www_ttl;q_ssh_ttl;q_syslog_ttl;q_postgresql_ttl;q_twitter_ttl;q_jira_ttl; q_github_ttl;} -> c_logstash->elasticsearch;
}
